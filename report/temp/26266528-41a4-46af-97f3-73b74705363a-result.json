{"name": "test_ecommerce[api_info0]", "status": "failed", "statusDetails": {"message": "AssertionError: 接口异常: {'api_info': 'today:21 max:10000 all[90=21+33+36];expires:2030-12-31', 'cache': 0, 'error_code': '0000', 'goodsList': [{'goodsId': '18382788819', 'goods_count': '233', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/bcf848aa71c6389607ae7a84b70f1543.jpeg', 'goods_name': '【2件套】套装秋冬新款仿獭兔毛钉珠皮草毛毛短外套加厚大衣女装', 'original_price': '', 'unit_price': '￥99.00'}, {'goodsId': '33809635011', 'goods_count': '521', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/176019babfdecffa1d9f98f40b7e99b4.jpeg', 'goods_name': '好奇小森林心钻装纸尿裤M22拉拉裤L18/XL14超薄透气裤型尿不湿 1件装', 'original_price': '', 'unit_price': '￥108.00'}, {'goodsId': '56996760797', 'goods_count': '1181', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '冻干鸡小胸整块增肥营养发腮狗狗零食新手养猫零食幼猫零食100g', 'original_price': '', 'unit_price': '￥17.80'}, {'goodsId': '82193785267', 'goods_count': '3000+', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '【自营】ISB伊珊娜意大利水果系列宠物犬猫沐浴露除臭香波护毛素', 'original_price': '', 'unit_price': '￥650.00'}, {'goodsId': '74190550836', 'goods_count': '1000+', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '【新品零0CM嵌入式】海尔电冰箱410L家用法式四门多门官方正品', 'original_price': '', 'unit_price': '￥5746.00'}], 'reason': '', 'request_id': 'request_id', 'secache': 'c98b29872e8a4b28859db207944ba817', 'secache_date': '2025-03-20 15:53:40', 'secache_time': 1742457220000, 'translate_language': 'zh-CN'}\nassert 'error' in {'api_info': 'today:21 max:10000 all[90=21+33+36];expires:2030-12-31', 'cache': 0, 'error_code': '0000', 'goodsList': ...images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '【新品零0CM嵌入式】海尔电冰箱410L家用法式四门多门官方正品', ...}], ...}", "trace": "api_info = {'baseInfo': {'api_name': '获取商品列表接口', 'headers': '{\"Content-Type\": \"application/x-www-form-urlencoded;charset=UTF-8\"}'...: {'msgType': 'getHandsetListOfCust', 'page': 1, 'size': 20}, 'validation': [{'code': 200}, {'contain': 'goodList'}]}]}\n\n    @pytest.mark.skipif(data is None, reason=\"ecommerce.yaml 读取失败，跳过测试\")\n    @pytest.mark.parametrize(\"api_info\", data if data else [{}])\n    def test_ecommerce(api_info):\n        # 预检查 YAML 数据格式\n        if not isinstance(api_info, dict):\n            pytest.skip(\"api_info 不是有效的字典，跳过测试\")\n        if 'baseInfo' not in api_info or 'testCase' not in api_info:\n            pytest.skip(\"api_info 缺少 baseInfo 或 testCase，跳过测试\")\n        if not isinstance(api_info.get('testCase'), list) or not api_info['testCase']:\n            pytest.skip(\"testCase 为空，跳过测试\")\n    \n        print(\"执行测试:\", api_info)\n    \n        # 构造完整 URL\n        config = ConfigParse()\n        full_url = config.get_host() + api_info['baseInfo'].get('url', '/post')\n    \n        # 复制测试用例数据\n        test_data = dict(api_info['testCase'][0])\n        case_name = test_data.pop('case_name', '默认用例')\n        validation = test_data.pop('validation', None)\n    \n        # 处理 headers\n        headers = api_info['baseInfo'].get('headers', '{\"Content-Type\": \"application/json\"}')\n        if isinstance(headers, str):\n            headers = json.loads(headers)\n    \n        # 发起请求\n        response = SendRequests().execute_api_request(\n            api_name=api_info['baseInfo'].get('api_name', '接口'),\n            url=full_url,\n            method=api_info['baseInfo'].get('method', 'POST'),\n            headers=headers,\n            case_name=case_name,\n            **test_data\n        )\n    \n        # 如果响应状态码不是 200，则跳过断言（或使用 pytest.fail 记录错误）\n        if response.status_code != 200:\n            pytest.skip(f\"接口返回状态码 {response.status_code}，跳过断言\")\n    \n        # 尝试解析 JSON 返回\n        try:\n            response_json = response.json()\n            print(\"接口返回内容：\", response.json())\n        except Exception:\n            pytest.fail(f\"响应不是 JSON：{response.text}\")\n    \n        # 如果 validation 为字典，则转换为列表\n        if isinstance(validation, dict):\n            validation = [validation]\n    \n        # 断言验证\n        response_json = response.json()\n        if \"status\" in response_json:\n            assert \"status\" in response_json, \"包含断言失败：'status' 不存在于响应中\"\n        else:\n>           assert \"error\" in response_json, f\"接口异常: {response_json}\"\nE           AssertionError: 接口异常: {'api_info': 'today:21 max:10000 all[90=21+33+36];expires:2030-12-31', 'cache': 0, 'error_code': '0000', 'goodsList': [{'goodsId': '18382788819', 'goods_count': '233', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/bcf848aa71c6389607ae7a84b70f1543.jpeg', 'goods_name': '【2件套】套装秋冬新款仿獭兔毛钉珠皮草毛毛短外套加厚大衣女装', 'original_price': '', 'unit_price': '￥99.00'}, {'goodsId': '33809635011', 'goods_count': '521', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/176019babfdecffa1d9f98f40b7e99b4.jpeg', 'goods_name': '好奇小森林心钻装纸尿裤M22拉拉裤L18/XL14超薄透气裤型尿不湿 1件装', 'original_price': '', 'unit_price': '￥108.00'}, {'goodsId': '56996760797', 'goods_count': '1181', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '冻干鸡小胸整块增肥营养发腮狗狗零食新手养猫零食幼猫零食100g', 'original_price': '', 'unit_price': '￥17.80'}, {'goodsId': '82193785267', 'goods_count': '3000+', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '【自营】ISB伊珊娜意大利水果系列宠物犬猫沐浴露除臭香波护毛素', 'original_price': '', 'unit_price': '￥650.00'}, {'goodsId': '74190550836', 'goods_count': '1000+', 'goods_image': 'https://omsproductionimg.yangkeduo.com/images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '【新品零0CM嵌入式】海尔电冰箱410L家用法式四门多门官方正品', 'original_price': '', 'unit_price': '￥5746.00'}], 'reason': '', 'request_id': 'request_id', 'secache': 'c98b29872e8a4b28859db207944ba817', 'secache_date': '2025-03-20 15:53:40', 'secache_time': 1742457220000, 'translate_language': 'zh-CN'}\nE           assert 'error' in {'api_info': 'today:21 max:10000 all[90=21+33+36];expires:2030-12-31', 'cache': 0, 'error_code': '0000', 'goodsList': ...images/2017-12-12/efb5db42397550bffd3211ca6f197498.jpeg', 'goods_name': '【新品零0CM嵌入式】海尔电冰箱410L家用法式四门多门官方正品', ...}], ...}\n\ntestcases\\test_ecommerce.py:89: AssertionError"}, "attachments": [{"name": "log", "source": "3960cd8d-7b43-44a7-b4bd-b6eb0973cb5a-attachment.txt", "type": "text/plain"}, {"name": "stdout", "source": "4be756ae-44cd-4eea-a0e1-39e12c10d5b2-attachment.txt", "type": "text/plain"}, {"name": "stderr", "source": "bd84e484-06a9-4ff4-8caf-71159801aa77-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "api_info", "value": "{'baseInfo': {'api_name': '获取商品列表接口', 'url': '/coupApply/cms/goodsList', 'method': 'GET', 'headers': '{\"Content-Type\": \"application/x-www-form-urlencoded;charset=UTF-8\"}'}, 'testCase': [{'case_name': '获取商品列表测试', 'params': {'msgType': 'getHandsetListOfCust', 'page': 1, 'size': 20}, 'validation': [{'code': 200}, {'contain': 'goodList'}]}]}"}], "start": 1742484493122, "stop": 1742484493137, "uuid": "d50a2922-a333-4bb5-8c50-189b2281860f", "historyId": "8e9648d6c15d0e10e1b48200d1f1dc30", "testCaseId": "13641d301f7968ae2cff765ba98e07b5", "fullName": "testcases.test_ecommerce#test_ecommerce", "labels": [{"name": "tag", "value": "@pytest.mark.skipif(False, reason='ecommerce.yaml 读取失败，跳过测试')"}, {"name": "parentSuite", "value": "testcases"}, {"name": "suite", "value": "test_ecommerce"}, {"name": "host", "value": "DESKTOP-PRRMS83"}, {"name": "thread", "value": "19432-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "testcases.test_ecommerce"}]}